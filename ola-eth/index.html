<!DOCTYPE html>
<html lang="en" dir="ltr">
 <head>
  <title>Hello, Ethers!</title>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script type="module">
      import { ethers } from "./ethers-5.1.esm.min.js";
      //const ethers = require('ethers')
      

      const GREETER_ADDRESS = '0xE0282e76237B8eB19A5D08e1741b8b3e2691Dadd';
      const GREETER_ABI = '[{"inputs":[{"internalType":"string","name":"_greeting","type":"string"}],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[],"name":"greet","outputs":[{"internalType":"string","name":"","type":"string"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"_greeting","type":"string"}],"name":"setGreeting","outputs":[],"stateMutability":"nonpayable","type":"function"}]';
      
      async function getGreeting() {
        // Wrap the window.ethereum object injected by MetaMask with the ethers API
        const provider = new ethers.providers.Web3Provider(window.ethereum);

        // Connect to the greeter contract.
        const greeterContract = new ethers.Contract(GREETER_ADDRESS, GREETER_ABI, provider);

        // Call the greet() smart contract function.
       const greeting = await greeterContract.greet();

        // Write the greeting result to the DOM.
        document.getElementById('output').innerHTML = greeting;


        //Explorando Ethers.js

        //Recupera o número do ultimo:
        const numeroUltimoBloco = await provider.getBlockNumber();
        document.getElementById('numeroUltimoBloco').innerHTML = numeroUltimoBloco;

        //Confere se a rede está conectada:
        const statusDeRede = await ethereum.isConnected();
        
        //Carrega as informações da rede atual (Ropstein)
        const redeAtual =  await provider.getNetwork();
        //Aqui o retorno é convertido para uma string:
        document.getElementById('redeAtual').innerHTML = JSON.stringify(redeAtual);

        //Escreve o retorno console:
        console.log(redeAtual);
        console.log(statusDeRede);
        console.log(numeroUltimoBloco);
      }
      getGreeting();
    
  </script>
  </head>
  <body>
    <h2>
    <div id="output">
    </div>

    <div id="numeroUltimoBloco">
    </div>

    <div id="redeAtual">
    </div>
    </h2>
  </body>
</html>
